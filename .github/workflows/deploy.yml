name: deploy-book

# Deze workflow draait wanneer er wijzigingen worden gepusht naar de `main` branch.
on:
  push:
    branches:
      - main

permissions:
  contents: read
  pages: write
  id-token: write
  
concurrency:
  group: "pages"
  cancel-in-progress: true
 
# Deze job installeert afhankelijkheden, bouwt het boek, en pusht het naar `gh-pages`.
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"
          cache: pip
        
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          python -m pip install -r requirements.txt
          python -m pip show jupyter-book
      
      - name: Build the book
        run: jupyter-book build .
      
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: _build/html

  deploy:
    runs-on: ubuntu-latest
    needs: build
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4

#    permissions:
#      pages: write      # Geeft toestemming om naar GitHub Pages te schrijven.
#      id-token: write   # Geeft toestemming om een token te gebruiken voor authenticatie.
#
#    steps:
#      # Checkt de repository code uit.
#      - uses: actions/checkout@v4
#
#      # Stelt Python in.
#      - name: Set up Python
#        uses: actions/setup-python@v5
#        with:
#          python-version: "3.11"  # Gebruik een stabiele Python-versie.
#          cache: pip               # Gebruikt pip-cache voor snellere installatie.
#          
#      # Installeert de benodigde Python-packages.
#      - name: Install dependencies
#        run: |
#          python -m pip install --upgrade pip
#          python -m pip install -r requirements.txt
#            
#      # Debug stap
#      - name: Show versions
#        run: |
#          python --version
#          pip show jupyter-book
#          jupyter-book --version
#          
#      # Bouwt het boek met Jupyter Book.
#      - name: Build the book
#        run: jupyter-book build .
#
#      # Controleer of de _build/html map bestaat
#      - name: Check build output
#        run: ls -la _build/html
#
#      # Uploadt de gegenereerde HTML-bestanden als een artifact.
#      - name: Upload artifact
#        uses: actions/upload-pages-artifact@v3
#        with:
#          path: _build/html  # Pad naar de gegenereerde HTML-bestanden.
#
#      # Deployt de HTML-bestanden naar GitHub Pages.
#      - name: Deploy to GitHub Pages
#        id: deployment
#        uses: actions/deploy-pages@v4